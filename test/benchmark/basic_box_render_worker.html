<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>

<body>
    <script src="../../dist/wd.js"></script>

    <script src="../e2e/js/AssetTool.js"></script>
    <script src="../e2e/js/ReplaceFetchTool.js"></script>
    <script src="../e2e/js/ScheduleTool.js"></script>
    <script src="../e2e/js/BasicBoxesTool.js"></script>
    <script src="../e2e/js/LightBoxesTool.js"></script>
    <script src="../e2e/js/LightTool.js"></script>
    <script src="../e2e/js/CameraTool.js"></script>
    <script src="../e2e/js/InstanceBasicBoxesTool.js"></script>
    <script src="../e2e/js/InstanceLightBoxesTool.js"></script>
    <script src="../e2e/js/RedoUndoTool.js"></script>
    <script src="../e2e/js/RandomTool.js"></script>

    <script>
        window.onload = function () {
            // wd.load("./data/").then(function (state) {
            //     console.log("complete", state);
            //     initSample(state);
            // });


            // wd.load("./data/").forEach(function (state) {
            //     console.log("next: ", state)
            // }).then(function (state) {
            //     console.log("complete: ", state);
            //     initSample(state);
            // })



            // wd.load("./data/").subscribe({
            //     next: (state) => {
            //         console.log("next: ", state)
            //     },
            //     complete: () => {
            //         console.log("complete");
            //         initSample(wd.getState());
            //     }
            // });





            AssetTool.load(["./data/setting.json", "./data/"], null, function () {
                return initSample(wd.getState());
            });

            function initSample(state) {
                var data = BasicBoxesTool.createBox(state);

                var state = data[0];
                var box = data[1];





                var data = BasicBoxesTool.createBox(state);

                var state = data[0];
                var box2 = data[1];




                var data = BasicBoxesTool.createCamera(state);
                var state = data[0];
                var camera = data[1];


                var transform = wd.unsafeGetGameObjectTransformComponent(camera, state);

                var state = wd.setTransformLocalPosition(transform, [0, 10, 30], state);




                // setTimeout(() => {
                //     var state = wd.getState();

                //     var state = wd.disposeGameObject(box, state);

                //     wd.setState(state);
                // }, 500)



                // setTimeout(() => {
                //     var state = wd.getState();

                //     var state = wd.disposeGameObject(box2, state);

                //     wd.setState(state);
                // }, 1000)





                // setTimeout(() => {
                //     var state = wd.getState();


                //     var data = BasicBoxesTool.createBox(state);

                //     var state = data[0];
                //     var box3 = data[1];

                //     var state = wd.initGameObject(box3, state);

                //     wd.setState(state);
                // }, 1500)



                return wd.startDirector(state);
            }






            // function initSample(state) {
            //     var [state, box] = createBox(state);


            //     var [state, camera] = createCamera(state);


            //     wd.startDirector(state);
            // }

            // function createBox(state) {
            //     var [state, material] = wd.createBasicMaterial(state);

            //     state = wd.setBasicMaterialColor(material, [0.0, 0.5, 0.2], state);

            //     var [state, meshRenderer] = wd.createMeshRenderer(state);

            //     var [state, obj] = wd.createGameObject(state);

            //     state = wd.addGameObjectBasicMaterialComponent(obj, material, state);
            //     state = wd.addGameObjectMeshRendererComponent(obj, meshRenderer, state);


            //     var [state, geometry] = wd.createBoxGeometry(state);

            //     state = wd.setBoxGeometryConfigData(geometry, {
            //         width: 5,
            //         height: 5,
            //         depth: 5
            //     }, state);




            //     state = wd.addGameObjectGeometryComponent(obj, geometry, state);

            //     return [state, obj];

            // }

            // function createCamera(state) {

            //     var [state, cameraProjection] = wd.createPerspectiveCameraProjection(state);

            //     state = wd.setPerspectiveCameraNear(cameraProjection, 0.1, state);
            //     state = wd.setPerspectiveCameraFar(cameraProjection, 2000, state);
            //     state = wd.setPerspectiveCameraFovy(cameraProjection, 60, state);
            //     state = wd.setPerspectiveCameraAspect(cameraProjection, 1.0, state);



            //     var [state, cameraView] = wd.createBasicCameraView(state);



            //     var [state, obj] = wd.createGameObject(state);

            //     state = wd.addGameObjectBasicCameraViewComponent(obj, cameraView, state);

            //     state = wd.addGameObjectPerspectiveCameraProjectionComponent(obj, cameraProjection, state);

            //     var transform = wd.unsafeGetGameObjectTransformComponent(obj, state);

            //     state = wd.setTransformLocalPosition(transform, [0, 0, 100], state);

            //     return [state, obj];
            // }
        }
    </script>
</body>

</html>