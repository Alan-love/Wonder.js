// Generated by BUCKLESCRIPT VERSION 2.1.0, PLEASE EDIT WITH CARE
'use strict';

import * as Contract$WonderLog                       from "../../../../../../../../node_modules/wonder-log/lib/es6_global/src/Contract.js";
import * as StateData$Wonderjs                       from "../../../../../core/StateData.js";
import * as BasicMaterialGroupCommon$Wonderjs        from "./BasicMaterialGroupCommon.js";
import * as BasicMaterialStateCommon$Wonderjs        from "./BasicMaterialStateCommon.js";
import * as MaterialDisposeComponentCommon$Wonderjs  from "../MaterialDisposeComponentCommon.js";
import * as ComponentDisposeComponentCommon$Wonderjs from "../../component/ComponentDisposeComponentCommon.js";

function isAlive(material, state) {
  return MaterialDisposeComponentCommon$Wonderjs.isAlive(material, BasicMaterialStateCommon$Wonderjs.getMaterialData(state)[/* disposedIndexArray */5]);
}

function _disposeData(material, data) {
  var match = MaterialDisposeComponentCommon$Wonderjs.disposeData(material, /* tuple */[
        data[/* shaderIndexMap */1],
        data[/* groupCountMap */4],
        data[/* gameObjectMap */3]
      ]);
  return /* record */[
          /* index */data[/* index */0],
          /* shaderIndexMap */match[0],
          /* colorMap */ComponentDisposeComponentCommon$Wonderjs.disposeSparseMapData(material, data[/* colorMap */2]),
          /* gameObjectMap */match[2],
          /* groupCountMap */match[1],
          /* disposedIndexArray */data[/* disposedIndexArray */5]
        ];
}

function _handleDispose(disposedIndexArray, material, state) {
  var match = BasicMaterialGroupCommon$Wonderjs.isGroupMaterial(material, state);
  if (match !== 0) {
    return BasicMaterialGroupCommon$Wonderjs.decreaseGroupCount(material, state);
  } else {
    var newrecord = state.slice();
    var newrecord$1 = _disposeData(material, BasicMaterialStateCommon$Wonderjs.getMaterialData(state)).slice();
    newrecord$1[/* disposedIndexArray */5] = MaterialDisposeComponentCommon$Wonderjs.addDisposeIndex(material, disposedIndexArray);
    newrecord[/* basicMaterialData */15] = newrecord$1;
    return newrecord;
  }
}

function handleDisposeComponent(material, state) {
  Contract$WonderLog.requireCheck((function () {
          return ComponentDisposeComponentCommon$Wonderjs.checkComponentShouldAlive(material, isAlive, state);
        }), StateData$Wonderjs.stateData[/* isDebug */1]);
  return _handleDispose(BasicMaterialStateCommon$Wonderjs.getMaterialData(state)[/* disposedIndexArray */5], material, state);
}

function handleBatchDisposeComponent(materialArray, _, state) {
  return MaterialDisposeComponentCommon$Wonderjs.handleBatchDisposeComponent(materialArray, BasicMaterialStateCommon$Wonderjs.getMaterialData(state)[/* disposedIndexArray */5], /* tuple */[
              isAlive,
              _handleDispose
            ], state);
}

export {
  isAlive                     ,
  _disposeData                ,
  _handleDispose              ,
  handleDisposeComponent      ,
  handleBatchDisposeComponent ,
  
}
/* Contract-WonderLog Not a pure module */
