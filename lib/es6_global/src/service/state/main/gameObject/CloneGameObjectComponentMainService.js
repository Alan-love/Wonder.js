// Generated by BUCKLESCRIPT VERSION 2.1.0, PLEASE EDIT WITH CARE
'use strict';

import * as Curry                                           from "../../../../../../../node_modules/bs-platform/lib/es6/curry.js";
import * as Caml_builtin_exceptions                         from "../../../../../../../node_modules/bs-platform/lib/es6/caml_builtin_exceptions.js";
import * as GetComponentGameObjectService$Wonderjs          from "../../../record/main/gameObject/GetComponentGameObjectService.js";
import * as CloneComponentGameObjectMainService$Wonderjs    from "./CloneComponentGameObjectMainService.js";
import * as CurrentComponentDataMapRenderService$Wonderjs   from "../../render/gameObject/CurrentComponentDataMapRenderService.js";
import * as BatchAddGameObjectComponentMainService$Wonderjs from "./BatchAddGameObjectComponentMainService.js";

function _clone(param, param$1, state) {
  var component = param[1];
  if (component) {
    var match = Curry._3(param$1[0], component[0], param[2], state);
    return Curry._3(param$1[1], param[3], match[1], state);
  } else {
    return state;
  }
}

function _cloneGeometryComponent(uid, countRangeArr, clonedGameObjectArr, state) {
  var gameObjectRecord = state[/* gameObjectRecord */10];
  var boxGeometryType = CurrentComponentDataMapRenderService$Wonderjs.getBoxGeometryType(/* () */0);
  var customGeometryType = CurrentComponentDataMapRenderService$Wonderjs.getCustomGeometryType(/* () */0);
  var match = GetComponentGameObjectService$Wonderjs.getGeometryComponentData(uid, gameObjectRecord);
  if (match) {
    var match$1 = match[0];
    var type_ = match$1[1];
    var component = match$1[0];
    if (type_ === boxGeometryType) {
      var match$2 = CloneComponentGameObjectMainService$Wonderjs.cloneBoxGeometryComponent(component, countRangeArr, state);
      return BatchAddGameObjectComponentMainService$Wonderjs.batchAddBoxGeometryComponentForClone(clonedGameObjectArr, match$2[1], state);
    } else if (type_ === customGeometryType) {
      var match$3 = CloneComponentGameObjectMainService$Wonderjs.cloneCustomGeometryComponent(component, countRangeArr, state);
      return BatchAddGameObjectComponentMainService$Wonderjs.batchAddCustomGeometryComponentForClone(clonedGameObjectArr, match$3[1], state);
    } else {
      throw [
            Caml_builtin_exceptions.match_failure,
            [
              "/Users/y/Github/Wonder.js/src/service/state/main/gameObject/CloneGameObjectComponentMainService.re",
              27,
              4
            ]
          ];
    }
  } else {
    return state;
  }
}

function _cloneComponentExceptTransform(param, isShareMaterial, state) {
  var clonedGameObjectArr = param[2];
  var countRangeArr = param[1];
  var uid = param[0];
  var gameObjectRecord = state[/* gameObjectRecord */10];
  return _clone(/* tuple */[
              uid,
              GetComponentGameObjectService$Wonderjs.getPointLightComponent(uid, gameObjectRecord),
              countRangeArr,
              clonedGameObjectArr
            ], /* tuple */[
              CloneComponentGameObjectMainService$Wonderjs.clonePointLightComponent,
              BatchAddGameObjectComponentMainService$Wonderjs.batchAddPointLightComponentForClone
            ], _clone(/* tuple */[
                  uid,
                  GetComponentGameObjectService$Wonderjs.getDirectionLightComponent(uid, gameObjectRecord),
                  countRangeArr,
                  clonedGameObjectArr
                ], /* tuple */[
                  CloneComponentGameObjectMainService$Wonderjs.cloneDirectionLightComponent,
                  BatchAddGameObjectComponentMainService$Wonderjs.batchAddDirectionLightComponentForClone
                ], _clone(/* tuple */[
                      uid,
                      GetComponentGameObjectService$Wonderjs.getAmbientLightComponent(uid, gameObjectRecord),
                      countRangeArr,
                      clonedGameObjectArr
                    ], /* tuple */[
                      CloneComponentGameObjectMainService$Wonderjs.cloneAmbientLightComponent,
                      BatchAddGameObjectComponentMainService$Wonderjs.batchAddAmbientLightComponentForClone
                    ], _clone(/* tuple */[
                          uid,
                          GetComponentGameObjectService$Wonderjs.getMeshRendererComponent(uid, gameObjectRecord),
                          countRangeArr,
                          clonedGameObjectArr
                        ], /* tuple */[
                          CloneComponentGameObjectMainService$Wonderjs.cloneMeshRendererComponent,
                          BatchAddGameObjectComponentMainService$Wonderjs.batchAddMeshRendererComponentForClone
                        ], _clone(/* tuple */[
                              uid,
                              GetComponentGameObjectService$Wonderjs.getLightMaterialComponent(uid, gameObjectRecord),
                              countRangeArr,
                              clonedGameObjectArr
                            ], /* tuple */[
                              (function (param, param$1, param$2) {
                                  return CloneComponentGameObjectMainService$Wonderjs.cloneLightMaterialComponent(isShareMaterial, param, param$1, param$2);
                                }),
                              (function (param, param$1, param$2) {
                                  return BatchAddGameObjectComponentMainService$Wonderjs.batchAddLightMaterialComponentForClone(isShareMaterial, param, param$1, param$2);
                                })
                            ], _clone(/* tuple */[
                                  uid,
                                  GetComponentGameObjectService$Wonderjs.getBasicMaterialComponent(uid, gameObjectRecord),
                                  countRangeArr,
                                  clonedGameObjectArr
                                ], /* tuple */[
                                  (function (param, param$1, param$2) {
                                      return CloneComponentGameObjectMainService$Wonderjs.cloneBasicMaterialComponent(isShareMaterial, param, param$1, param$2);
                                    }),
                                  (function (param, param$1, param$2) {
                                      return BatchAddGameObjectComponentMainService$Wonderjs.batchAddBasicMaterialComponentForClone(isShareMaterial, param, param$1, param$2);
                                    })
                                ], _clone(/* tuple */[
                                      uid,
                                      GetComponentGameObjectService$Wonderjs.getPerspectiveCameraProjectionComponent(uid, gameObjectRecord),
                                      countRangeArr,
                                      clonedGameObjectArr
                                    ], /* tuple */[
                                      CloneComponentGameObjectMainService$Wonderjs.clonePerspectiveCameraProjectionComponent,
                                      BatchAddGameObjectComponentMainService$Wonderjs.batchAddPerspectiveCameraProjectionComponentForClone
                                    ], _clone(/* tuple */[
                                          uid,
                                          GetComponentGameObjectService$Wonderjs.getBasicCameraViewComponent(uid, gameObjectRecord),
                                          countRangeArr,
                                          clonedGameObjectArr
                                        ], /* tuple */[
                                          CloneComponentGameObjectMainService$Wonderjs.cloneBasicCameraViewComponent,
                                          BatchAddGameObjectComponentMainService$Wonderjs.batchAddBasicCameraViewComponentForClone
                                        ], _cloneGeometryComponent(uid, countRangeArr, clonedGameObjectArr, state)))))))));
}

function clone(param, isShareMaterial, state) {
  var clonedGameObjectArr = param[3];
  var countRangeArr = param[2];
  var match = CloneComponentGameObjectMainService$Wonderjs.cloneTransformComponent(param[1], countRangeArr, _cloneComponentExceptTransform(/* tuple */[
            param[0],
            countRangeArr,
            clonedGameObjectArr
          ], isShareMaterial, state));
  var clonedTransformArr = match[1];
  return /* tuple */[
          BatchAddGameObjectComponentMainService$Wonderjs.batchAddTransformComponentForClone(clonedGameObjectArr, clonedTransformArr, match[0]),
          clonedTransformArr
        ];
}

export {
  _clone                         ,
  _cloneGeometryComponent        ,
  _cloneComponentExceptTransform ,
  clone                          ,
  
}
/* GetComponentGameObjectService-Wonderjs Not a pure module */
