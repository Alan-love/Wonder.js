// Generated by BUCKLESCRIPT VERSION 2.1.0, PLEASE EDIT WITH CARE
'use strict';

import * as Caml_int32                                                   from "../../../../../../../../node_modules/bs-platform/lib/es6/caml_int32.js";
import * as ArrayService$Wonderjs                                        from "../../../../atom/ArrayService.js";
import * as OptionService$Wonderjs                                       from "../../../../atom/OptionService.js";
import * as SparseMapService$Wonderjs                                    from "../../../../atom/SparseMapService.js";
import * as ArrayService$WonderCommonlib                                 from "../../../../../../../../node_modules/wonder-commonlib/lib/es6_global/src/ArrayService.js";
import * as BufferSettingService$Wonderjs                                from "../../../../record/main/setting/BufferSettingService.js";
import * as CopyTypeArrayService$Wonderjs                                from "../../../../primitive/copy/CopyTypeArrayService.js";
import * as SparseMapService$WonderCommonlib                             from "../../../../../../../../node_modules/wonder-commonlib/lib/es6_global/src/SparseMapService.js";
import * as IndexSourceTextureMainService$Wonderjs                       from "../IndexSourceTextureMainService.js";
import * as BufferSourceSizeTextureService$Wonderjs                      from "../../../../record/main/texture/BufferSourceSizeTextureService.js";
import * as RecordSourceTextureMainService$Wonderjs                      from "../RecordSourceTextureMainService.js";
import * as BufferArrayBufferViewSourceTextureService$Wonderjs           from "../../../../record/main/texture/BufferArrayBufferViewSourceTextureService.js";
import * as CreateTypeArrayArrayBufferViewSourceTextureService$Wonderjs  from "../../../../record/all/texture/arrayBufferView_source/CreateTypeArrayArrayBufferViewSourceTextureService.js";
import * as OperateTypeArrayArrayBufferViewSourceTextureService$Wonderjs from "../../../../record/all/texture/arrayBufferView_source/OperateTypeArrayArrayBufferViewSourceTextureService.js";

function getRecord(param) {
  return OptionService$Wonderjs.unsafeGet(param[/* arrayBufferViewSourceTextureRecord */19]);
}

function setAllTypeArrDataToDefault(arrayBufferViewSourceTextureCount, _, param) {
  var defaultWrapS = BufferArrayBufferViewSourceTextureService$Wonderjs.getDefaultWrapS(/* () */0);
  var defaultWrapT = BufferArrayBufferViewSourceTextureService$Wonderjs.getDefaultWrapT(/* () */0);
  var defaultMagFilter = BufferArrayBufferViewSourceTextureService$Wonderjs.getDefaultMagFilter(/* () */0);
  var defaultMinFilter = BufferArrayBufferViewSourceTextureService$Wonderjs.getDefaultMinFilter(/* () */0);
  var defaultFormat = BufferArrayBufferViewSourceTextureService$Wonderjs.getDefaultFormat(/* () */0);
  var defaultType = BufferArrayBufferViewSourceTextureService$Wonderjs.getDefaultType(/* () */0);
  var defaultIsNeedUpdate = BufferArrayBufferViewSourceTextureService$Wonderjs.getDefaultIsNeedUpdate(/* () */0);
  var defaultWidth = BufferArrayBufferViewSourceTextureService$Wonderjs.getDefaultWidth(/* () */0);
  var defaultHeight = BufferArrayBufferViewSourceTextureService$Wonderjs.getDefaultHeight(/* () */0);
  return ArrayService$WonderCommonlib.reduceOneParam((function (param, indexInTypeArray) {
                return /* tuple */[
                        OperateTypeArrayArrayBufferViewSourceTextureService$Wonderjs.setWrapS(indexInTypeArray, defaultWrapS, param[0]),
                        OperateTypeArrayArrayBufferViewSourceTextureService$Wonderjs.setWrapT(indexInTypeArray, defaultWrapT, param[1]),
                        OperateTypeArrayArrayBufferViewSourceTextureService$Wonderjs.setMagFilter(indexInTypeArray, defaultMagFilter, param[2]),
                        OperateTypeArrayArrayBufferViewSourceTextureService$Wonderjs.setMinFilter(indexInTypeArray, defaultMinFilter, param[3]),
                        OperateTypeArrayArrayBufferViewSourceTextureService$Wonderjs.setFormat(indexInTypeArray, defaultFormat, param[4]),
                        OperateTypeArrayArrayBufferViewSourceTextureService$Wonderjs.setType(indexInTypeArray, defaultType, param[5]),
                        OperateTypeArrayArrayBufferViewSourceTextureService$Wonderjs.setIsNeedUpdate(indexInTypeArray, defaultIsNeedUpdate, param[6]),
                        OperateTypeArrayArrayBufferViewSourceTextureService$Wonderjs.setWidth(indexInTypeArray, defaultWidth, param[7]),
                        OperateTypeArrayArrayBufferViewSourceTextureService$Wonderjs.setHeight(indexInTypeArray, defaultHeight, param[8])
                      ];
              }), /* tuple */[
              param[0],
              param[1],
              param[2],
              param[3],
              param[4],
              param[5],
              param[6],
              param[7],
              param[8]
            ], ArrayService$Wonderjs.range(0, arrayBufferViewSourceTextureCount - 1 | 0));
}

function _initBufferData(basicSourceTextureCount, arrayBufferViewSourceTextureCount, buffer, arrayBufferViewSourceTextureIndexOffset) {
  var match = CreateTypeArrayArrayBufferViewSourceTextureService$Wonderjs.createTypeArrays(buffer, basicSourceTextureCount, arrayBufferViewSourceTextureCount);
  return setAllTypeArrDataToDefault(arrayBufferViewSourceTextureCount, arrayBufferViewSourceTextureIndexOffset, /* tuple */[
              match[0],
              match[1],
              match[2],
              match[3],
              match[4],
              match[5],
              match[6],
              match[7],
              match[8]
            ]);
}

function create(state) {
  var settingRecord = state[/* settingRecord */0];
  var basicSourceTextureCount = BufferSettingService$Wonderjs.getBasicSourceTextureCount(settingRecord);
  var arrayBufferViewSourceTextureCount = BufferSettingService$Wonderjs.getArrayBufferViewSourceTextureCount(settingRecord);
  var match = RecordSourceTextureMainService$Wonderjs.getRecord(state);
  var match$1 = _initBufferData(basicSourceTextureCount, arrayBufferViewSourceTextureCount, match[/* buffer */0], IndexSourceTextureMainService$Wonderjs.getArrayBufferViewSourceTextureIndexOffset(state));
  state[/* arrayBufferViewSourceTextureRecord */19] = /* Some */[/* record */[
      /* index */0,
      /* wrapSs */match$1[0],
      /* wrapTs */match$1[1],
      /* magFilters */match$1[2],
      /* minFilters */match$1[3],
      /* formats */match$1[4],
      /* types */match$1[5],
      /* isNeedUpdates */match$1[6],
      /* widths */match$1[7],
      /* heights */match$1[8],
      /* sourceMap */SparseMapService$WonderCommonlib.createEmpty(/* () */0),
      /* glTextureMap */SparseMapService$WonderCommonlib.createEmpty(/* () */0),
      /* bindTextureUnitCacheMap */SparseMapService$WonderCommonlib.createEmpty(/* () */0),
      /* disposedIndexArray */ArrayService$WonderCommonlib.createEmpty(/* () */0),
      /* needAddedSourceArray : array */[],
      /* needInitedTextureIndexArray : int array */[]
    ]];
  return state;
}

function deepCopyForRestore(state) {
  var record = getRecord(state);
  var index = record[/* index */0];
  var newrecord = state.slice();
  newrecord[/* arrayBufferViewSourceTextureRecord */19] = /* Some */[/* record */[
      /* index */index,
      /* wrapSs */CopyTypeArrayService$Wonderjs.copyUint8ArrayWithEndIndex(Caml_int32.imul(index, BufferSourceSizeTextureService$Wonderjs.getWrapSsSize(/* () */0)), record[/* wrapSs */1]),
      /* wrapTs */CopyTypeArrayService$Wonderjs.copyUint8ArrayWithEndIndex(Caml_int32.imul(index, BufferSourceSizeTextureService$Wonderjs.getWrapTsSize(/* () */0)), record[/* wrapTs */2]),
      /* magFilters */CopyTypeArrayService$Wonderjs.copyUint8ArrayWithEndIndex(Caml_int32.imul(index, BufferSourceSizeTextureService$Wonderjs.getMagFiltersSize(/* () */0)), record[/* magFilters */3]),
      /* minFilters */CopyTypeArrayService$Wonderjs.copyUint8ArrayWithEndIndex(Caml_int32.imul(index, BufferSourceSizeTextureService$Wonderjs.getMinFiltersSize(/* () */0)), record[/* minFilters */4]),
      /* formats */CopyTypeArrayService$Wonderjs.copyUint8ArrayWithEndIndex(Caml_int32.imul(index, BufferSourceSizeTextureService$Wonderjs.getFormatsSize(/* () */0)), record[/* formats */5]),
      /* types */CopyTypeArrayService$Wonderjs.copyUint8ArrayWithEndIndex(Caml_int32.imul(index, BufferSourceSizeTextureService$Wonderjs.getTypesSize(/* () */0)), record[/* types */6]),
      /* isNeedUpdates */CopyTypeArrayService$Wonderjs.copyUint8ArrayWithEndIndex(Caml_int32.imul(index, BufferSourceSizeTextureService$Wonderjs.getIsNeedUpdatesSize(/* () */0)), record[/* isNeedUpdates */7]),
      /* widths */CopyTypeArrayService$Wonderjs.copyUint16ArrayWithEndIndex(Caml_int32.imul(index, BufferSourceSizeTextureService$Wonderjs.getWidthsSize(/* () */0)), record[/* widths */8]),
      /* heights */CopyTypeArrayService$Wonderjs.copyUint16ArrayWithEndIndex(Caml_int32.imul(index, BufferSourceSizeTextureService$Wonderjs.getHeightsSize(/* () */0)), record[/* heights */9]),
      /* sourceMap */SparseMapService$Wonderjs.copy(record[/* sourceMap */10]),
      /* glTextureMap */SparseMapService$Wonderjs.copy(record[/* glTextureMap */11]),
      /* bindTextureUnitCacheMap */SparseMapService$WonderCommonlib.createEmpty(/* () */0),
      /* disposedIndexArray */record[/* disposedIndexArray */13].slice(),
      /* needAddedSourceArray */record[/* needAddedSourceArray */14].slice(),
      /* needInitedTextureIndexArray */record[/* needInitedTextureIndexArray */15].slice()
    ]];
  return newrecord;
}

export {
  getRecord                  ,
  setAllTypeArrDataToDefault ,
  _initBufferData            ,
  create                     ,
  deepCopyForRestore         ,
  
}
/* ArrayService-Wonderjs Not a pure module */
