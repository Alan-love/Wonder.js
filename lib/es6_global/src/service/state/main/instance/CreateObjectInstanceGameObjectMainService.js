// Generated by BUCKLESCRIPT VERSION 2.1.0, PLEASE EDIT WITH CARE
'use strict';

import * as BufferSettingService$Wonderjs              from "../../../record/main/setting/BufferSettingService.js";
import * as CreateTransformMainService$Wonderjs        from "../transform/CreateTransformMainService.js";
import * as CreateObjectInstanceService$Wonderjs       from "../../../record/main/instance/objectInstance/CreateObjectInstanceService.js";
import * as ObjectInstanceCollectionService$Wonderjs   from "../../../primitive/instance/ObjectInstanceCollectionService.js";
import * as RecordSourceInstanceMainService$Wonderjs   from "./RecordSourceInstanceMainService.js";
import * as AddGameObjectComponentMainService$Wonderjs from "../gameObject/AddGameObjectComponentMainService.js";
import * as CreateGameObjectGameObjectService$Wonderjs from "../../../record/main/gameObject/CreateGameObjectGameObjectService.js";

function createInstance(sourceInstance, state) {
  var gameObjectRecord = state[/* gameObjectRecord */10];
  var match = CreateGameObjectGameObjectService$Wonderjs.create(gameObjectRecord);
  var uid = match[1];
  var match$1 = CreateTransformMainService$Wonderjs.create(state);
  var transform = match$1[1];
  var state$1 = match$1[0];
  var sourceInstanceRecord = RecordSourceInstanceMainService$Wonderjs.getRecord(state$1);
  state$1[/* gameObjectRecord */10] = match[0];
  var match$2 = ObjectInstanceCollectionService$Wonderjs.addObjectInstanceTransform(sourceInstance, transform, BufferSettingService$Wonderjs.getObjectInstanceCountPerSourceInstance(state[/* settingRecord */0]), /* tuple */[
        sourceInstanceRecord[/* objectInstanceTransformIndexMap */1],
        sourceInstanceRecord[/* objectInstanceTransformCollections */4]
      ]);
  var newrecord = sourceInstanceRecord.slice();
  state$1[/* sourceInstanceRecord */6] = /* Some */[(newrecord[/* objectInstanceTransformIndexMap */1] = match$2[0], newrecord[/* objectInstanceTransformCollections */4] = match$2[1], newrecord)];
  var match$3 = CreateObjectInstanceService$Wonderjs.create(sourceInstance, uid, state$1[/* objectInstanceRecord */7]);
  state$1[/* objectInstanceRecord */7] = match$3[0];
  var state$2 = AddGameObjectComponentMainService$Wonderjs.addObjectInstanceComponent(uid, match$3[1], AddGameObjectComponentMainService$Wonderjs.addTransformComponent(uid, transform, state$1));
  return /* tuple */[
          state$2,
          uid
        ];
}

export {
  createInstance ,
  
}
/* BufferSettingService-Wonderjs Not a pure module */
