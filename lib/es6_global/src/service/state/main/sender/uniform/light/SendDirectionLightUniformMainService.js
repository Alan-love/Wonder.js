// Generated by BUCKLESCRIPT VERSION 2.1.0, PLEASE EDIT WITH CARE
'use strict';

import * as Caml_array                                 from "../../../../../../../../../node_modules/bs-platform/lib/es6/caml_array.js";
import * as Log$WonderLog                              from "../../../../../../../../../node_modules/wonder-log/lib/es6_global/src/Log.js";
import * as Contract$WonderLog                         from "../../../../../../../../../node_modules/wonder-log/lib/es6_global/src/Contract.js";
import * as MainStateData$Wonderjs                     from "../../../data/MainStateData.js";
import * as IsDebugMainService$Wonderjs                from "../../../state/IsDebugMainService.js";
import * as ArrayService$WonderCommonlib               from "../../../../../../../../../node_modules/wonder-commonlib/lib/es6_global/src/ArrayService.js";
import * as ReduceStateMainService$Wonderjs            from "../../../array/ReduceStateMainService.js";
import * as GLSLLocationMainService$Wonderjs           from "../../../location/GLSLLocationMainService.js";
import * as SendGLSLDataMainService$Wonderjs           from "../../SendGLSLDataMainService.js";
import * as RecordDirectionLightService$Wonderjs       from "../../../../../record/light/direction/RecordDirectionLightService.js";
import * as OperateDirectionLightService$Wonderjs      from "../../../../../record/light/direction/OperateDirectionLightService.js";
import * as PositionDirectionLightMainService$Wonderjs from "../../../light/direction/PositionDirectionLightMainService.js";

function send(gl, param, state) {
  var uniformLocationMap = param[2];
  var uniformCacheMap = param[1];
  var program = param[0];
  Contract$WonderLog.requireCheck((function () {
          var maxCount = RecordDirectionLightService$Wonderjs.getBufferMaxCount(/* () */0);
          return Contract$WonderLog.test(Log$WonderLog.buildAssertMessage("max buffer count === 4", "is " + (String(maxCount) + "")), (function () {
                        return Contract$WonderLog.Operators[/* = */0](maxCount, 4);
                      }));
        }), IsDebugMainService$Wonderjs.getIsDebug(MainStateData$Wonderjs.stateData));
  var match = state[/* directionLightRecord */18];
  var lightGLSLDataStructureMemberNameArr = /* array */[
    /* record */[
      /* position */"u_directionLights[0].position",
      /* color */"u_directionLights[0].color",
      /* intensity */"u_directionLights[0].intensity"
    ],
    /* record */[
      /* position */"u_directionLights[1].position",
      /* color */"u_directionLights[1].color",
      /* intensity */"u_directionLights[1].intensity"
    ],
    /* record */[
      /* position */"u_directionLights[2].position",
      /* color */"u_directionLights[2].color",
      /* intensity */"u_directionLights[2].intensity"
    ],
    /* record */[
      /* position */"u_directionLights[3].position",
      /* color */"u_directionLights[3].color",
      /* intensity */"u_directionLights[3].intensity"
    ]
  ];
  return ReduceStateMainService$Wonderjs.reduceState((function (state, index) {
                var match = Caml_array.caml_array_get(lightGLSLDataStructureMemberNameArr, index);
                var intensity = match[/* intensity */2];
                var color = match[/* color */1];
                var position = match[/* position */0];
                SendGLSLDataMainService$Wonderjs.sendVec3(gl, uniformCacheMap, /* tuple */[
                      position,
                      GLSLLocationMainService$Wonderjs.getUniformLocation(program, position, uniformLocationMap, gl)
                    ], PositionDirectionLightMainService$Wonderjs.getPosition(index, state));
                SendGLSLDataMainService$Wonderjs.sendFloat3(gl, uniformCacheMap, /* tuple */[
                      color,
                      GLSLLocationMainService$Wonderjs.getUniformLocation(program, color, uniformLocationMap, gl)
                    ], OperateDirectionLightService$Wonderjs.getColor(index, state[/* directionLightRecord */18]));
                SendGLSLDataMainService$Wonderjs.sendFloat(gl, uniformCacheMap, /* tuple */[
                      intensity,
                      GLSLLocationMainService$Wonderjs.getUniformLocation(program, intensity, uniformLocationMap, gl)
                    ], OperateDirectionLightService$Wonderjs.getIntensity(index, state[/* directionLightRecord */18]));
                return state;
              }), state, ArrayService$WonderCommonlib.range(0, match[/* index */0] - 1 | 0));
}

export {
  send ,
  
}
/* Log-WonderLog Not a pure module */
