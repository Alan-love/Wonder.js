// Generated by BUCKLESCRIPT VERSION 2.1.0, PLEASE EDIT WITH CARE
'use strict';

import * as ArraySystem$Wonderjs                       from "../../../../../../structure/ArraySystem.js";
import * as GeometryAdmin$Wonderjs                     from "../../../../../../ecs/admin/component/GeometryAdmin.js";
import * as InstanceUtils$Wonderjs                     from "../../../../../../renderer/utils/InstanceUtils.js";
import * as GameObjectAdmin$Wonderjs                   from "../../../../../../ecs/admin/GameObjectAdmin.js";
import * as RenderDataSystem$Wonderjs                  from "../../../../../../renderer/render/RenderDataSystem.js";
import * as GLSLSenderDrawUtils$Wonderjs               from "../../../../../../renderer/shader/sender/utils/GLSLSenderDrawUtils.js";
import * as FrontRenderLightJobCommon$Wonderjs         from "./FrontRenderLightJobCommon.js";
import * as FrontRenderLightInstanceJobCommon$Wonderjs from "./instance/FrontRenderLightInstanceJobCommon.js";

function _getLightMaterialRenderArray(renderArray, state) {
  return renderArray.filter((function (uid) {
                return GameObjectAdmin$Wonderjs.hasLightMaterialComponent(uid, state);
              }));
}

function _render(gl, state) {
  var match = RenderDataSystem$Wonderjs.getRenderArrayFromState(state);
  if (match) {
    return ArraySystem$Wonderjs.reduceState((function (state, uid) {
                  if (InstanceUtils$Wonderjs.isSourceInstance(uid, state)) {
                    return FrontRenderLightInstanceJobCommon$Wonderjs.render(gl, uid, state);
                  } else {
                    var match = FrontRenderLightJobCommon$Wonderjs.render(gl, uid, state);
                    var state$1 = match[0];
                    GLSLSenderDrawUtils$Wonderjs.drawElement(/* tuple */[
                          GeometryAdmin$Wonderjs.getDrawMode(gl),
                          GeometryAdmin$Wonderjs.getIndexType(gl),
                          GeometryAdmin$Wonderjs.getIndexTypeSize(gl),
                          GeometryAdmin$Wonderjs.getIndicesCount(match[2], state$1)
                        ], gl);
                    return state$1;
                  }
                }), state, _getLightMaterialRenderArray(match[0], state));
  } else {
    return state;
  }
}

function execJob(_, gl, state) {
  return _render(gl, state);
}

export {
  _getLightMaterialRenderArray ,
  _render                      ,
  execJob                      ,
  
}
/* ArraySystem-Wonderjs Not a pure module */
