// Generated by BUCKLESCRIPT VERSION 4.0.0, PLEASE EDIT WITH CARE

import * as ArrayService$Wonderjs from "../../../service/atom/ArrayService.js";
import * as RenderJobUtils$Wonderjs from "./RenderJobUtils.js";
import * as ArrayService$WonderCommonlib from "../../../../../../node_modules/wonder-commonlib/lib/es6_global/src/ArrayService.js";
import * as RenderBasicJobCommon$Wonderjs from "../../common/render_basic/RenderBasicJobCommon.js";
import * as ShaderIndexRenderService$Wonderjs from "../../../service/state/render/shader/ShaderIndexRenderService.js";
import * as RenderBasicInstanceJobCommon$Wonderjs from "../../common/render_basic/instance/RenderBasicInstanceJobCommon.js";
import * as RenderObjectBufferTypeArrayService$Wonderjs from "../../../service/record/main/render/RenderObjectBufferTypeArrayService.js";
import * as ShaderIndexBasicMaterialRenderService$Wonderjs from "../../../service/state/render/material/basic/ShaderIndexBasicMaterialRenderService.js";

function _getShaderIndex(materialIndex, state) {
  return ShaderIndexRenderService$Wonderjs.getShaderIndex(materialIndex, ShaderIndexBasicMaterialRenderService$Wonderjs.getShaderIndex, state);
}

function render(gl, param, state) {
  var sourceInstanceIndices = param[5];
  var geometryTypes = param[4];
  var geometryIndices = param[3];
  var materialIndices = param[2];
  var transformIndices = param[1];
  return ArrayService$WonderCommonlib.reduceOneParam((function (state, index) {
                var transformIndex = RenderObjectBufferTypeArrayService$Wonderjs.getComponent(index, transformIndices);
                var materialIndex = RenderObjectBufferTypeArrayService$Wonderjs.getComponent(index, materialIndices);
                var shaderIndex = ShaderIndexRenderService$Wonderjs.getShaderIndex(materialIndex, ShaderIndexBasicMaterialRenderService$Wonderjs.getShaderIndex, state);
                var geometryIndex = RenderObjectBufferTypeArrayService$Wonderjs.getComponent(index, geometryIndices);
                var geometryType = RenderObjectBufferTypeArrayService$Wonderjs.getGeometryType(index, geometryTypes);
                var sourceInstance = RenderObjectBufferTypeArrayService$Wonderjs.getComponent(index, sourceInstanceIndices);
                if (RenderObjectBufferTypeArrayService$Wonderjs.hasSourceInstance(sourceInstance)) {
                  return RenderBasicInstanceJobCommon$Wonderjs.render(gl, /* tuple */[
                              transformIndex,
                              materialIndex,
                              shaderIndex,
                              geometryIndex,
                              geometryType,
                              sourceInstance
                            ], state);
                } else {
                  var state$1 = RenderBasicJobCommon$Wonderjs.render(gl, /* tuple */[
                        transformIndex,
                        materialIndex,
                        shaderIndex,
                        geometryIndex,
                        geometryType
                      ], state);
                  RenderJobUtils$Wonderjs.draw(gl, geometryIndex, geometryType, state$1);
                  return state$1;
                }
              }), state, ArrayService$Wonderjs.range(0, param[0] - 1 | 0));
}

export {
  _getShaderIndex ,
  render ,
  
}
/* ArrayService-Wonderjs Not a pure module */
