<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>仿射变幻</title>

    <script src="/project/dist/Engine.js" type="text/javascript"></script>
</head>
<body>
<canvas id="canvas" width="600" height="400"></canvas>

<script>
    window.onload = function(){
        var camera = null,
                scene = null;

        Engine3D.LoaderManager.getInstance().load([
            {url:"../vertex.glsl", id:"vs"},
            {url:"../fragment.glsl", id:"fs"}
        ]);

        function init(){
            _initContext();
            _initScene();

        }

        function _initContext(){
            Engine3D.WebGLContext.createGL("canvas");
        }

        function _initScene(){
            var geometry = null;

            camera = Engine3D.Camera.create({
                        eyeX: 0.0,
                        eyeY: 0.0,
                        eyeZ: 10.0,
                        centerX:0,
                        centerY:0,
                        centerZ: -1,
                        upX:0,
                        upY: 1,
                        upZ: 0
                    },
                    {
                        angle: 60,
                        aspect : canvas.width / canvas.height,
                        near : 0.1,
                        far : 100
                    });

            scene = Engine3D.Scene.create(camera,
                    Engine3D.GLSLLoader.getInstance().getGLSL("vs"),
                    Engine3D.GLSLLoader.getInstance().getGLSL("fs"));


            var material = Engine3D.MeshMaterial.create( { color: "#FFCDff"} );
//            geometry = Engine3D.BoxGeometry.create(5, 5, 1, material);
            geometry = Engine3D.TriangleGeometry.create(5, 5, material);
//            geometry = Engine3D.RectGeometry.create(5, 5, material);
//            geometry = Engine3D.SphereGeometry.create(5, Engine3D.SphereDrawMode.LATITUDELONGTITUDE, 20, material);

            var mesh = Engine3D.Mesh.create(geometry);

//            mesh.runAction(Engine3D.Translate.create(
//                    mesh.matrix, {
//                        x: 1, y: 2, z: 3
//                    }
//            ));
//            mesh.runAction(Engine3D.Rotate.create(
//               mesh.matrix, {
//                        speed: 0.4,
//                        axis: [Engine3D.Vector3.create(2, 0, 0),
//                            Engine3D.Vector3.create(2, 1, 0)]
//                    }
//            ));
            var rotateAction = Engine3D.Rotate.create(
                    mesh.matrix, {
                        speed: 0.5,
                        axis: [Engine3D.Vector3.create(0, 1, 0)]
                    }
            );
            var scaleAction = Engine3D.Scale.create(
                    mesh.matrix, {
                        x: 2,
                        y:1,
                        z:1
                    }
            );

            mesh.runAction(rotateAction);
            mesh.runAction(rotateAction);
            mesh.runAction(rotateAction);
            mesh.runAction(rotateAction);
            mesh.runAction(rotateAction);
            mesh.runAction(rotateAction);
            mesh.runAction(rotateAction);
            mesh.runAction(rotateAction);
            mesh.runAction(rotateAction);

            mesh.runAction(scaleAction);
//            mesh.runAction(Engine3D.Rotate.create(
//               mesh.matrix, {
//                        speed: 0.4,
//                        axis: [Engine3D.Vector3.create(2, 0, 0),
//                            Engine3D.Vector3.create(2, 1, 0)]
//                    }
//            ));

            scene.add(mesh);


            var director = Engine3D.Director.getInstance();

            //can set renderer
//            digeometryor.renderer

            director.runWithScene(scene);
        }

        Engine3D.LoaderManager.getInstance().onload = function(){
            init();
        };
    };
</script>
</body>
</html>
